import {Send} from "./process.helper.mjs";

const testData = "{\"sentTs\":1719598801521,\"BTC\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"BTC\",\"value\":60702.906235925,\"metadata\":{\"value\":\"60702.906235925\",\"sourceMetadata\":{\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":60700.829408965,\"askPrice\":60700.839393710005,\"volumeInUsd\":229405955.032752},\"value\":\"60700.839393710005\"},\"bitmart-usdt\":{\"tradeInfo\":{\"bidPrice\":60702.896251180005,\"askPrice\":60702.916220670006,\"volumeInUsd\":336281785.6021754},\"value\":\"60702.906235925\"},\"bitrue-usdt\":{\"tradeInfo\":{\"bidPrice\":60702.896251180005,\"askPrice\":60702.906235925,\"volumeInUsd\":673387720.3779373},\"value\":\"60702.906235925\"},\"coinbasepro-usd\":{\"tradeInfo\":{\"bidPrice\":60690.01,\"askPrice\":60690.02,\"volumeInUsd\":573929004.8762634},\"value\":\"60690.01\"},\"coingecko\":{\"value\":\"60719\"},\"coinmarketcap\":{\"value\":\"60715.05252350857\"},\"kraken-usd\":{\"tradeInfo\":{\"bidPrice\":60743.2,\"askPrice\":60743.3,\"volumeInUsd\":44969970.366651565},\"value\":\"60743.3\"},\"mexc-usdt\":{\"tradeInfo\":{\"bidPrice\":60702.896251180005,\"askPrice\":60702.906235925,\"volumeInUsd\":508102906.7074558},\"value\":\"60702.896251180005\"},\"okx-usdt\":{\"tradeInfo\":{\"bidPrice\":60697.664244800006,\"askPrice\":60697.76409225,\"volumeInUsd\":372428453.99370766},\"value\":\"60702.157380050005\"},\"xt\":{\"value\":\"60795.64\"},\"binance-usdt\":{\"tradeInfo\":{\"bidPrice\":60702.896251180005,\"askPrice\":60702.906235925,\"volumeInUsd\":1420665193.989598},\"value\":\"60702.906235925\"},\"binancecoinm-usd\":{\"tradeInfo\":{\"volumeInUsd\":1526540423.4714043},\"value\":\"60738\"},\"binanceusdm-usdt\":{\"value\":\"60690.17568605\"},\"kucoin-usdt\":{\"tradeInfo\":{\"bidPrice\":60703.35554945,\"askPrice\":60703.255702,\"volumeInUsd\":112759747.95831056},\"value\":\"60703.35554945\"},\"bingx-usdt\":{\"tradeInfo\":{\"bidPrice\":60701.508371625,\"askPrice\":60702.01759362,\"volumeInUsd\":81286010.56710833},\"value\":\"60701.99762413\"},\"bitfinex2-usd\":{\"tradeInfo\":{\"bidPrice\":60885,\"askPrice\":60886,\"volumeInUsd\":51692373.87027805},\"value\":\"60905\"},\"bitstamp-usd\":{\"tradeInfo\":{\"bidPrice\":60693,\"askPrice\":60694,\"volumeInUsd\":89262376.79756545},\"value\":\"60693\"},\"kaiko\":{\"value\":\"60742.925502410726\"},\"kaiko-v2\":{\"value\":\"60702.89991695599\"}},\"nodeLabel\":\"main-bnb-btc\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"BTC\",\"signature\":\"HH6UVAuKVDbybYMDogN0jbeKFEwp/hVUPNfKmSSZsSsgBN0I5m6xtUH6nZPxUFm6uutrzB15mLmcecw/2WYoChw=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":60702.906235925}},\"ETH\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"ETH\",\"value\":3380.4652214350003,\"metadata\":{\"value\":\"3380.4652214350003\",\"sourceMetadata\":{\"binance-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.085801125,\"askPrice\":3380.0957858700003,\"volumeInUsd\":758130465.4513654},\"value\":\"3380.15569434\"},\"binancecoinm-usd\":{\"tradeInfo\":{\"volumeInUsd\":896578854.1824858},\"value\":\"3380.97\"},\"binanceusdm-usdt\":{\"value\":\"3379.55660964\"},\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.3853434750004,\"askPrice\":3380.39532822,\"volumeInUsd\":136271533.87133288},\"value\":\"3380.39532822\"},\"bitmart-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.45523669,\"askPrice\":3380.47520618,\"volumeInUsd\":207824578.64733478},\"value\":\"3380.47520618\"},\"coingecko\":{\"value\":\"3382.53\"},\"coinmarketcap\":{\"value\":\"3382.9859622857334\"},\"kucoin-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.45523669,\"askPrice\":3380.445251945,\"volumeInUsd\":112834407.11555913},\"value\":\"3380.45523669\"},\"mexc-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.4652214350003,\"askPrice\":3380.47520618,\"volumeInUsd\":123060000.17308699},\"value\":\"3380.4652214350003\"},\"lbank-usdt\":{\"tradeInfo\":{\"volumeInUsd\":355099838.420023},\"value\":\"3380.4652214350003\"},\"okx-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.07581638,\"askPrice\":3380.085801125,\"volumeInUsd\":208215866.4484893},\"value\":\"3380.105770615\"},\"xt\":{\"value\":\"3385.63\"},\"bingx-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.365373985,\"askPrice\":3380.39532822,\"volumeInUsd\":30413355.521569513},\"value\":\"3380.3753587300002\"},\"bitfinex2-usd\":{\"tradeInfo\":{\"bidPrice\":3389.8,\"askPrice\":3389.9,\"volumeInUsd\":4655767.600058259},\"value\":\"3390.5\"},\"bitrue-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.445251945,\"askPrice\":3380.51514516,\"volumeInUsd\":135255952.51561233},\"value\":\"3380.47520618\"},\"bitstamp-usd\":{\"tradeInfo\":{\"bidPrice\":3379.7,\"askPrice\":3380.1,\"volumeInUsd\":13869004.110132385},\"value\":\"3380.4\"},\"coinbasepro-usd\":{\"tradeInfo\":{\"bidPrice\":3379.97,\"askPrice\":3379.98,\"volumeInUsd\":336162330.9741335},\"value\":\"3380.11\"},\"kaiko\":{\"value\":\"3382.8751031165075\"},\"kaiko-v2\":{\"value\":\"3380.4533185842724\"},\"kraken-usd\":{\"tradeInfo\":{\"bidPrice\":3380.72,\"askPrice\":3380.73,\"volumeInUsd\":43341823.28721605},\"value\":\"3380.73\"},\"gate-usdt\":{\"tradeInfo\":{\"bidPrice\":3380.245557045,\"askPrice\":3380.2555417900003,\"volumeInUsd\":556327699.1158962},\"value\":\"3380.245557045\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"ETH\",\"signature\":\"5Q3bQ69msfPVkrUdsUHffyxj2rfDa3jNUfoL6ZubrogBp0yah6AmVJA50rSKjMnkBhD/LAW9uPUYxf2sCCUTmxs=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":3380.4652214350003}},\"USDC\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"USDC\",\"value\":0.999835735,\"metadata\":{\"value\":\"0.999835735\",\"sourceMetadata\":{\"binance-usdt\":{\"tradeInfo\":{\"bidPrice\":0.9996726694,\"askPrice\":0.99977251685,\"volumeInUsd\":1136601672.1829417},\"value\":\"0.99977251685\"},\"binanceusdm-usdt\":{\"value\":\"0.9993122201055\"},\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":0.9996726694,\"askPrice\":0.99977251685,\"volumeInUsd\":7027128.533054008},\"value\":\"0.9996726694\"},\"bitmart-usdt\":{\"tradeInfo\":{\"bidPrice\":0.99803517122,\"askPrice\":0.99929324909,\"volumeInUsd\":1238641.613699181},\"value\":\"0.998963752505\"},\"bitrue-usdt\":{\"tradeInfo\":{\"bidPrice\":0.9996726694,\"askPrice\":0.99977251685,\"volumeInUsd\":10980206.664103195},\"value\":\"0.99977251685\"},\"bitstamp-usd\":{\"tradeInfo\":{\"bidPrice\":0.99984,\"askPrice\":0.99989,\"volumeInUsd\":1498545.935545616},\"value\":\"0.99983\"},\"coingecko\":{\"value\":\"1\"},\"coinmarketcap\":{\"value\":\"0.9999893020217416\"},\"curve-ethereum-dai\":{\"slippage\":[{\"slippageAsPercent\":\"0.000031\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"0.000065\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"0.99985901\"},\"curve-ethereum-usdt\":{\"slippage\":[{\"slippageAsPercent\":\"0.000042\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"-0.000028\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"0.99989616\"},\"kaiko\":{\"value\":\"0.9998544552914541\"},\"kaiko-v2\":{\"value\":\"0.9999191022382699\"},\"kraken-usdt\":{\"tradeInfo\":{\"bidPrice\":0.9998723643,\"askPrice\":0.99997221175,\"volumeInUsd\":14092548.563516973},\"value\":\"0.9998723643\"},\"kucoin-usdt\":{\"tradeInfo\":{\"bidPrice\":0.999802471085,\"askPrice\":0.99979248634,\"volumeInUsd\":4230029.11551443},\"value\":\"0.999802471085\"},\"lbank-usdt\":{\"tradeInfo\":{\"volumeInUsd\":4835485.45824972},\"value\":\"0.99977251685\"},\"maverick-ethereum-usdt\":{\"slippage\":[{\"slippageAsPercent\":\"21.073180\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"13.394235\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"0.99926472\"},\"mexc-usdt\":{\"tradeInfo\":{\"bidPrice\":0.9996726694,\"askPrice\":0.99977251685,\"volumeInUsd\":9221861.082474113},\"value\":\"0.9996726694\"},\"okx-usdt\":{\"tradeInfo\":{\"bidPrice\":0.99997221175,\"askPrice\":1.0000720592,\"volumeInUsd\":16098463.69736474},\"value\":\"1.0000720592\"},\"uniswap-v3-ethereum-dai-100\":{\"slippage\":[{\"slippageAsPercent\":\"-0.000051\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"-0.000096\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"0.99984147\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"USDC\",\"signature\":\"oQi+Bpiml+Voqls0zIwtoRbgbYv0FDrZGCIP69V1roFEOvDRupOJE4oE9R4oGLp9S1R/I5U8JTy4/0ImKg4GyRs=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":0.999835735}},\"USDT\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"USDT\",\"value\":0.9984745,\"metadata\":{\"value\":\"0.9984745\",\"sourceMetadata\":{\"bitstamp-usd\":{\"tradeInfo\":{\"bidPrice\":0.99835,\"askPrice\":0.99853,\"volumeInUsd\":15241811.42292891},\"value\":\"0.99833\"},\"coinbasepro-usd\":{\"tradeInfo\":{\"bidPrice\":0.99846,\"askPrice\":0.99847,\"volumeInUsd\":580520766.6236373},\"value\":\"0.99847\"},\"coingecko\":{\"value\":\"0.998479\"},\"coinmarketcap\":{\"value\":\"0.9984331737916382\"},\"kaiko\":{\"value\":\"0.998480874308636\"},\"kaiko-v2\":{\"value\":\"0.998499130740279\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"USDT\",\"signature\":\"mgmumfo1GiTTOz5nqtMW42D8soaWlBrYUwRQkXxSJ9ZW216fijHwX43RdX8EzxjMO0HIMFA/yIpz8vVif25hERs=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":0.9984745}},\"SOL\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"SOL\",\"value\":141.43145722525,\"metadata\":{\"value\":\"141.43145722525\",\"sourceMetadata\":{\"binance-usdt\":{\"tradeInfo\":{\"bidPrice\":141.374004455,\"askPrice\":141.3839892,\"volumeInUsd\":483212189.1036788},\"value\":\"141.3839892\"},\"binanceusdm-usdt\":{\"value\":\"141.42991902699998\"},\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":141.4329144505,\"askPrice\":141.43391292500002,\"volumeInUsd\":89170781.86601013},\"value\":\"141.4329144505\"},\"coingecko\":{\"value\":\"141.42\"},\"coinmarketcap\":{\"value\":\"141.652684072749\"},\"kucoin-usdt\":{\"tradeInfo\":{\"bidPrice\":141.42292970550002,\"askPrice\":141.421931231,\"volumeInUsd\":39583819.94293803},\"value\":\"141.42292970550002\"},\"mexc-usdt\":{\"tradeInfo\":{\"bidPrice\":141.40395869000002,\"askPrice\":141.413943435,\"volumeInUsd\":41821153.367735244},\"value\":\"141.43391292500002\"},\"lbank-usdt\":{\"tradeInfo\":{\"volumeInUsd\":12297062.191225832},\"value\":\"141.50380614\"},\"okx-usdt\":{\"tradeInfo\":{\"bidPrice\":141.40395869000002,\"askPrice\":141.413943435,\"volumeInUsd\":124612761.2963466},\"value\":\"141.43391292500002\"},\"xt\":{\"value\":\"141.62\"},\"bingx-usdt\":{\"tradeInfo\":{\"bidPrice\":141.40395869000002,\"askPrice\":141.43391292500002,\"volumeInUsd\":9044677.12456557},\"value\":\"141.413943435\"},\"bitfinex2-usd\":{\"tradeInfo\":{\"bidPrice\":141.78,\"askPrice\":141.87,\"volumeInUsd\":1650801.3084148385},\"value\":\"141.79\"},\"bitstamp-usd\":{\"tradeInfo\":{\"bidPrice\":141.373,\"askPrice\":141.4073,\"volumeInUsd\":2719142.653461},\"value\":\"141.3591\"},\"coinbasepro-usd\":{\"tradeInfo\":{\"bidPrice\":141.4,\"askPrice\":141.41,\"volumeInUsd\":145813701.1337547},\"value\":\"141.41\"},\"kraken-usd\":{\"tradeInfo\":{\"bidPrice\":141.4,\"askPrice\":141.41,\"volumeInUsd\":37700410.202768035},\"value\":\"141.43\"},\"gate-usdt\":{\"tradeInfo\":{\"bidPrice\":141.45388241499998,\"askPrice\":141.46386716,\"volumeInUsd\":43507228.7894837},\"value\":\"141.44389767\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"SOL\",\"signature\":\"3pP2e5DDQ/g8N78HyHuM7JrW0KkB6/0PRDF12in5P7E78wCXtc2CRvLsfGKLn7SWKH3thxSZsZps67mhr3F7KBw=\"},\"verifiedPackage\":{\"a\":\"0x9c5AE89C4Af6aA32cE58588DBaF90d18a855B6de\",\"t\":1719598790000,\"v\":141.43145722525}},\"stETH\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"stETH\",\"value\":3379.355657284285,\"metadata\":{\"value\":\"3379.355657284285\",\"sourceMetadata\":{\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":3374.694038825,\"askPrice\":3383.1311483500003,\"volumeInUsd\":72359.99607612756},\"value\":\"3379.466746935\"},\"coinmarketcap\":{\"value\":\"3382.0596279556207\"},\"bingx-usdt\":{\"tradeInfo\":{\"bidPrice\":3378.8676622350004,\"askPrice\":3379.55660964,\"volumeInUsd\":779047.58717508},\"value\":\"3379.227113055\"},\"curve-ethereum-eth\":{\"slippage\":[{\"slippageAsPercent\":\"0.000042\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"0.000042\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"3380.07301701\"},\"curve-ethereum-eth-2\":{\"slippage\":[{\"slippageAsPercent\":\"0.000022\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"0.000022\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"3379.23786343\"},\"curve-ethereum-weth\":{\"slippage\":[{\"slippageAsPercent\":\"0.001434\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"0.001458\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"3379.2602327\"},\"okx-eth\":{\"tradeInfo\":{\"bidPrice\":3379.45108186857,\"askPrice\":3379.7891283907134,\"volumeInUsd\":268733.2380268004},\"value\":\"3379.45108186857\"},\"uniswap-v2-ethereum-weth\":{\"slippage\":[{\"slippageAsPercent\":\"0.216873\",\"direction\":\"buy\",\"simulationValueInUsd\":\"10000\"},{\"slippageAsPercent\":\"0.216567\",\"direction\":\"sell\",\"simulationValueInUsd\":\"10000\"}],\"value\":\"3374.57475049\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"stETH\",\"signature\":\"VMaGSgJYrGk/Ucpa5VzxhgKd7Fl91sBK/7bLXAhVnLBmC4ozwEFIHLW2EZv/YMjlp4pgVOU8+KAXNK4QP9MTlRw=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":3379.355657284285}},\"AR\":{\"rawPackage\":{\"dataPoints\":[{\"dataFeedId\":\"AR\",\"value\":26.217943421,\"metadata\":{\"value\":\"26.217943421\",\"sourceMetadata\":{\"binance-usdt\":{\"tradeInfo\":{\"bidPrice\":26.215946472,\"askPrice\":26.221937319,\"volumeInUsd\":21899145.052079946},\"value\":\"26.2149479975\"},\"bitget-usdt\":{\"tradeInfo\":{\"bidPrice\":26.215946472,\"askPrice\":26.253888503,\"volumeInUsd\":2970007.0719991303},\"value\":\"26.251891554\"},\"bitmart-usdt\":{\"tradeInfo\":{\"bidPrice\":26.16831923835,\"askPrice\":26.2694647052,\"volumeInUsd\":394179.1652677404},\"value\":\"26.2241339629\"},\"bitrue-usdt\":{\"tradeInfo\":{\"bidPrice\":26.154041053,\"askPrice\":26.3008168045,\"volumeInUsd\":4050217.285666034},\"value\":\"26.2189418955\"},\"coingecko\":{\"value\":\"26.23\"},\"kucoin-usdt\":{\"tradeInfo\":{\"bidPrice\":26.231922064,\"askPrice\":26.203964778,\"volumeInUsd\":1063881.4144904737},\"value\":\"26.2169449465\"},\"mexc-usdt\":{\"tradeInfo\":{\"bidPrice\":26.2169449465,\"askPrice\":26.223934268,\"volumeInUsd\":266898.478309523},\"value\":\"26.217943421\"},\"okx-usdt\":{\"tradeInfo\":{\"bidPrice\":26.2129510485,\"askPrice\":26.2229357935,\"volumeInUsd\":2546344.634834153},\"value\":\"26.209955625\"},\"bingx-usdt\":{\"tradeInfo\":{\"bidPrice\":26.217943421,\"askPrice\":26.223934268,\"volumeInUsd\":345356.69343933003},\"value\":\"26.2209388445\"},\"xt\":{\"value\":\"26.255\"},\"gate-usdt\":{\"tradeInfo\":{\"bidPrice\":26.209955625,\"askPrice\":26.21994037,\"volumeInUsd\":1779652.4723072601},\"value\":\"26.209955625\"},\"binance-btc\":{\"tradeInfo\":{\"bidPrice\":26.19937433142523,\"askPrice\":26.21758520329601,\"volumeInUsd\":861948.5927827372},\"value\":\"26.20544462204882\"},\"bybit-usdt\":{\"tradeInfo\":{\"bidPrice\":26.19907225295,\"askPrice\":26.2185425057,\"volumeInUsd\":114357.21154078499},\"value\":\"26.21564692965\"}},\"nodeLabel\":\"main\"}}],\"timestampMilliseconds\":1719598790000,\"dataFeedId\":\"AR\",\"signature\":\"CAuAhkfYyBhe07YvPFRz5+Eb2nCeMu3c4H31WgLL34x+lizQGaL8ZgO/bBVHGcqmHpO6nl3URxCYp84rhP8v7Bw=\"},\"verifiedPackage\":{\"a\":\"0x51Ce04Be4b3E32572C4Ec9135221d0691Ba7d202\",\"t\":1719598790000,\"v\":26.217943421}}}"

async function doTest() {
  const result = await Send({
    Action: 'storePrices',
    Owner: 'jnioZFibZSCcV8o-HkBXYPYEYNib4tqfexP0kCBXX_M',
    Data: testData
  });
  console.log(result);

  const result2 = await Send({
    Action: 'requestLatestData',
    Tickers: JSON.stringify(['AR', 'ETH']),
    Owner: 'jnioZFibZSCcV8o-HkBXYPYEYNib4tqfexP0kCBXX_M',
    Data: '1234'
  });
  console.dir(result2, {depth: null});
}

doTest().catch(console.error).finally(console.log)